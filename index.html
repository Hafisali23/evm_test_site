<!DOCTYPE html>
<html lang="ml">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Web EVM Demo</title>

  <!-- Malayalam font -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Malayalam:wght@400;600&display=swap" rel="stylesheet">

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      font-size: 16px;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Noto Sans Malayalam', sans-serif;
      background: #eef1f5;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: clamp(8px, 3vw, 24px);
      font-size: clamp(14px, 2vw, 16px);
      overflow-x: hidden;
    }

    .evm-wrapper {
      background: #f8fafc;
      border-radius: clamp(12px, 2vw, 18px);
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.15);
      max-width: 500px;
      width: 100%;
      padding: clamp(12px, 3vw, 20px);
      border: 1px solid #e2e8f0;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }

    .evm-header {
      text-align: center;
      margin-bottom: clamp(10px, 2vw, 16px);
    }

    .evm-title {
      font-size: clamp(16px, 4vw, 20px);
      font-weight: 700;
      color: #111827;
      margin-bottom: clamp(3px, 1vw, 6px);
      font-family: 'Noto Sans Malayalam', system-ui, sans-serif;
      line-height: 1.3;
    }

    .evm-subtitle {
      font-size: clamp(11px, 2.5vw, 14px);
      color: #374151;
      font-family: 'Noto Sans Malayalam', system-ui, sans-serif;
      line-height: 1.4;
    }

    .evm-rows {
      display: flex;
      flex-direction: column;
      gap: clamp(8px, 1.5vw, 12px);
      margin-top: clamp(6px, 1.5vw, 10px);
    }

    .evm-row {
      display: grid;
      grid-template-columns: 0.7fr 2fr 1fr 0.7fr 1.2fr;
      align-items: center;
      padding: clamp(6px, 1.5vw, 10px);
      border-radius: clamp(8px, 1.5vw, 12px);
      background: #ffffff;
      border: 1px solid #e5e7eb;
      gap: 8px;
    }

    /* Tablet/Laptop adjustments */
    @media (max-width: 768px) {
      .evm-row {
        grid-template-columns: 0.6fr 1.8fr 0.9fr 0.6fr 1.1fr;
        padding: 8px 10px;
      }
      
      .evm-wrapper {
        max-width: 95%;
      }
    }

    /* Mobile adjustments */
    @media (max-width: 480px) {
      .evm-row {
        grid-template-columns: 0.5fr 1.6fr 0.8fr 0.5fr 1fr;
        padding: 6px 8px;
        gap: 6px;
      }
      
      body {
        padding: 12px;
      }
      
      .evm-rows {
        gap: 8px;
      }
    }

    /* Small mobile adjustments */
    @media (max-width: 360px) {
      .evm-row {
        grid-template-columns: 0.5fr 1.5fr 0.7fr 0.5fr 0.9fr;
        padding: 5px 6px;
        gap: 4px;
      }
      
      .evm-title {
        font-size: 15px;
      }
      
      .evm-subtitle {
        font-size: 11px;
      }
    }

    /* Very small screens */
    @media (max-width: 320px) {
      .evm-row {
        grid-template-columns: 0.4fr 1.4fr 0.6fr 0.4fr 0.8fr;
        padding: 4px 5px;
      }
      
      .vote-btn {
        min-width: 50px;
        padding: 4px 8px;
        font-size: 11px;
      }
    }

    .serial {
      font-size: clamp(12px, 2.5vw, 14px);
      font-weight: 600;
      color: #111827;
      text-align: center;
      min-width: 24px;
    }

    .candidate-name {
      font-family: 'Noto Sans Malayalam', system-ui, sans-serif;
      font-size: clamp(12px, 2.5vw, 14px);
      font-weight: 500;
      color: #111827;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      padding-right: 4px;
    }

    .candidate-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      min-width: 30px;
    }

    .candidate-icon img {
      width: clamp(28px, 6vw, 36px);
      height: clamp(28px, 6vw, 36px);
      border-radius: clamp(4px, 1vw, 6px);
      object-fit: cover;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
    }

    .placeholder {
      border-radius: 6px;
      border: 1px dashed #d1d5db;
      background: #f3f4f6;
      height: clamp(24px, 5vw, 32px);
    }

    .placeholder.name {
      width: 100%;
    }

    .placeholder.icon {
      width: clamp(28px, 6vw, 36px);
      margin: 0 auto;
    }

    .led {
      width: clamp(12px, 3vw, 16px);
      height: clamp(12px, 3vw, 16px);
      border-radius: 999px;
      margin: 0 auto;
      background: #991b1b;
      box-shadow: inset 0 0 3px rgba(0,0,0,0.4);
    }

    .led.off {
      background: #7f1d1d;
      opacity: 0.45;
      box-shadow: none;
    }

    .led.on {
      background: #ef4444;
      box-shadow: 0 0 8px rgba(239, 68, 68, 0.9);
      opacity: 1;
    }

    .led-hidden {
      visibility: hidden;
    }

    @keyframes led-blink {
      0%, 100% { opacity: 0.25; box-shadow: none; }
      50% { opacity: 1; box-shadow: 0 0 8px rgba(239, 68, 68, 0.9); }
    }

    .blinking {
      animation: led-blink 0.4s linear infinite;
    }

    .vote-btn {
      font-size: clamp(11px, 2.5vw, 13px);
      font-weight: 600;
      padding: clamp(4px, 1vw, 6px) clamp(8px, 1.5vw, 12px);
      border-radius: 999px;
      border: 0;
      background: #2563eb;
      color: white;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: clamp(50px, 8vw, 65px);
      box-shadow: 0 2px 6px rgba(37, 99, 235, 0.55);
      transition: background 0.15s ease, transform 0.1s ease, box-shadow 0.15s ease;
      white-space: nowrap;
    }

    .vote-btn:hover:not(:disabled) {
      background: #1d4ed8;
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(37, 99, 235, 0.7);
    }

    .vote-btn:active:not(:disabled) {
      transform: translateY(0);
      box-shadow: 0 1px 4px rgba(37, 99, 235, 0.4);
    }

    .vote-btn:disabled {
      cursor: not-allowed;
      background: #93c5fd;
      box-shadow: none;
      opacity: 0.85;
    }

    .vote-btn.hidden {
      visibility: hidden;
    }

    /* Modal */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      padding: clamp(12px, 3vw, 24px);
      backdrop-filter: blur(3px);
      overflow: hidden;
    }

    .modal-backdrop.open {
      display: flex;
    }

    .modal-card {
      width: min(420px, 90vw);
      max-height: 90vh;
      background: linear-gradient(135deg, #f9fafb 0%, #f1f5f9 100%);
      border-radius: clamp(16px, 3vw, 24px);
      padding: clamp(16px, 3vw, 24px);
      position: relative;
      overflow: hidden;
      box-shadow: 
        0 20px 50px rgba(15, 23, 42, 0.4),
        0 0 0 1px rgba(255, 255, 255, 0.2) inset;
      border: 1px solid rgba(255, 255, 255, 0.3);
      transform: scale(0.8) translateY(30px);
      opacity: 0;
    }

    @media (max-width: 480px) {
      .modal-card {
        padding: 16px;
        border-radius: 16px;
      }
    }

    .modal-backdrop.open .modal-card {
      animation: modal-pop 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
    }

    @keyframes modal-pop {
      0% { 
        transform: scale(0.8) translateY(30px); 
        opacity: 0; 
      }
      60% { 
        transform: scale(1.05) translateY(-5px); 
        opacity: 1; 
      }
      80% { 
        transform: scale(0.98) translateY(0); 
      }
      100% { 
        transform: scale(1) translateY(0); 
        opacity: 1; 
      }
    }

    .modal-close {
      position: absolute;
      top: clamp(8px, 1.5vw, 12px);
      right: clamp(8px, 1.5vw, 12px);
      width: clamp(28px, 4vw, 36px);
      height: clamp(28px, 4vw, 36px);
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #ffffff 0%, #f1f5f9 100%);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 2;
      transform: scale(0);
    }

    .modal-backdrop.open .modal-close {
      animation: button-pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.5s forwards;
    }

    @keyframes button-pop {
      0% { transform: scale(0) rotate(-90deg); }
      70% { transform: scale(1.1) rotate(10deg); }
      100% { transform: scale(1) rotate(0); }
    }

    .modal-close:hover {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      transform: scale(1.1) rotate(90deg);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
    }

    .modal-close span {
      font-size: clamp(16px, 2.5vw, 20px);
      color: #64748b;
      font-weight: 600;
      transition: color 0.3s ease;
    }

    .modal-close:hover span {
      color: #ef4444;
    }

    /* Success checkmark */
    .success-check {
      position: absolute;
      top: -25px;
      left: 50%;
      transform: translateX(-50%) scale(0);
      width: clamp(40px, 8vw, 50px);
      height: clamp(40px, 8vw, 50px);
      border-radius: 50%;
      background: linear-gradient(135deg, #10b981 0%, #059669 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
      z-index: 1;
    }

    .modal-backdrop.open .success-check {
      animation: check-pop 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.3s forwards;
    }

    @keyframes check-pop {
      0% { 
        transform: translateX(-50%) scale(0) rotate(-180deg); 
        opacity: 0; 
      }
      50% { 
        transform: translateX(-50%) scale(1.2) rotate(20deg); 
        opacity: 1; 
      }
      70% { 
        transform: translateX(-50%) scale(0.9) rotate(-10deg); 
      }
      100% { 
        transform: translateX(-50%) scale(1) rotate(0); 
        opacity: 1; 
      }
    }

    .success-check::after {
      content: '‚úì';
      font-size: clamp(20px, 4vw, 26px);
      color: white;
      font-weight: bold;
    }

    .modal-title {
      text-align: center;
      font-family: 'Noto Sans Malayalam', system-ui, sans-serif;
      font-weight: 700;
      font-size: clamp(18px, 4vw, 24px);
      margin-top: clamp(16px, 3vw, 24px);
      margin-bottom: clamp(6px, 1.5vw, 10px);
      color: #111827;
      background: linear-gradient(135deg, #111827 0%, #374151 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      transform: translateY(20px);
      opacity: 0;
      line-height: 1.3;
      padding: 0 8px;
    }

    .modal-backdrop.open .modal-title {
      animation: text-slide 0.5s ease-out 0.4s forwards;
    }

    @keyframes text-slide {
      0% { 
        transform: translateY(20px); 
        opacity: 0; 
      }
      100% { 
        transform: translateY(0); 
        opacity: 1; 
      }
    }

    .modal-subtitle {
      font-family: 'Noto Sans Malayalam', system-ui, sans-serif;
      font-size: clamp(13px, 3vw, 16px);
      color: #4b5563;
      text-align: center;
      margin-bottom: clamp(12px, 2.5vw, 18px);
      font-weight: 500;
      transform: translateY(20px);
      opacity: 0;
      line-height: 1.4;
      padding: 0 8px;
    }

    .modal-backdrop.open .modal-subtitle {
      animation: text-slide 0.5s ease-out 0.5s forwards;
    }

    .modal-poster {
      width: 100%;
      border-radius: clamp(12px, 2.5vw, 16px);
      overflow: hidden;
      border: 2px solid #e5e7eb;
      margin: clamp(10px, 2vw, 16px) 0;
      background: #e5e7eb;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      position: relative;
      transform: scale(0.9) rotateX(20deg);
      opacity: 0;
      filter: brightness(1.1) contrast(1.1);
    }

    .modal-backdrop.open .modal-poster {
      animation: poster-reveal 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.6s forwards;
    }

    @keyframes poster-reveal {
      0% { 
        transform: scale(0.9) rotateX(20deg) translateY(30px); 
        opacity: 0; 
      }
      60% { 
        transform: scale(1.05) rotateX(-5deg) translateY(-10px); 
        opacity: 1; 
      }
      80% { 
        transform: scale(0.98) rotateX(2deg) translateY(0); 
      }
      100% { 
        transform: scale(1) rotateX(0) translateY(0); 
        opacity: 1; 
      }
    }

    .modal-poster::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(16, 185, 129, 0.1) 100%);
      z-index: 1;
      opacity: 0;
    }

    .modal-backdrop.open .modal-poster::before {
      animation: poster-glow 2s ease-in-out 1s forwards;
    }

    @keyframes poster-glow {
      0%, 100% { opacity: 0; }
      50% { opacity: 1; }
    }

    .modal-poster img {
      width: 100%;
      display: block;
      object-fit: cover;
      transition: transform 0.5s ease;
    }

    .modal-poster:hover img {
      transform: scale(1.05);
    }

    .modal-footer-text {
      text-align: center;
      font-size: clamp(12px, 2.5vw, 14px);
      color: #374151;
      margin-top: clamp(8px, 2vw, 12px);
      font-family: 'Noto Sans Malayalam', system-ui, sans-serif;
      font-weight: 500;
      transform: translateY(20px);
      opacity: 0;
      line-height: 1.4;
      padding: 0 8px;
    }

    .modal-backdrop.open .modal-footer-text {
      animation: text-slide 0.5s ease-out 0.8s forwards;
    }

    .modal-subtext {
      text-align: center;
      font-size: clamp(10px, 2vw, 12px);
      margin-top: clamp(4px, 1vw, 6px);
      color: #6b7280;
      transform: translateY(20px);
      opacity: 0;
      line-height: 1.4;
      padding: 0 8px;
    }

    .modal-backdrop.open .modal-subtext {
      animation: text-slide 0.5s ease-out 0.9s forwards;
    }

    /* ========== ENHANCED PARTY EFFECTS ========== */

    /* Floating Emoji Particles */
    .emoji-particle {
      position: absolute;
      font-size: clamp(20px, 4vw, 28px);
      opacity: 0;
      pointer-events: none;
      z-index: 100;
    }

    /* Main confetti container */
    .confetti-container {
      position: absolute;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 50;
    }

    /* Standard Confetti */
    .confetti {
      position: absolute;
      font-size: clamp(16px, 3vw, 22px);
      opacity: 0;
      animation: confetti-fall 2s cubic-bezier(0.215, 0.61, 0.355, 1) forwards;
    }

    @keyframes confetti-fall {
      0% { 
        transform: translateY(-100px) rotate(0deg) scale(0); 
        opacity: 0; 
      }
      15% { 
        opacity: 1; 
        transform: translateY(0) rotate(180deg) scale(1); 
      }
      100% { 
        transform: translateY(120vh) rotate(720deg) scale(1); 
        opacity: 0; 
      }
    }

    /* Glitter Particles */
    .glitter {
      position: absolute;
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: gold;
      box-shadow: 0 0 10px gold;
      opacity: 0;
      pointer-events: none;
      z-index: 50;
    }

    @keyframes glitter-fall {
      0% {
        transform: translateY(-100px) translateX(0) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) translateX(100px) rotate(360deg);
        opacity: 0;
      }
    }

    /* Streamer Effects */
    .streamer {
      position: absolute;
      width: 4px;
      height: 40px;
      opacity: 0;
      pointer-events: none;
      z-index: 50;
      transform-origin: top center;
    }

    .streamer.red { background: linear-gradient(to bottom, #ef4444, #fca5a5); }
    .streamer.blue { background: linear-gradient(to bottom, #3b82f6, #93c5fd); }
    .streamer.green { background: linear-gradient(to bottom, #10b981, #a7f3d0); }
    .streamer.yellow { background: linear-gradient(to bottom, #f59e0b, #fde68a); }
    .streamer.purple { background: linear-gradient(to bottom, #8b5cf6, #ddd6fe); }

    @keyframes streamer-fall {
      0% {
        transform: translateY(-100px) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }

    /* Bubble Effects */
    .bubble {
      position: absolute;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      opacity: 0;
      pointer-events: none;
      z-index: 50;
    }

    @keyframes bubble-rise {
      0% {
        transform: translateY(100vh) scale(0);
        opacity: 0;
      }
      20% {
        opacity: 0.8;
        transform: translateY(80vh) scale(1);
      }
      100% {
        transform: translateY(-100px) scale(1.2);
        opacity: 0;
      }
    }

    /* Fireworks */
    .firework {
      position: absolute;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      opacity: 0;
      pointer-events: none;
      z-index: 50;
    }

    @keyframes firework-explode {
      0% {
        transform: translate(0, 0) scale(0);
        opacity: 0;
      }
      10% {
        opacity: 1;
      }
      100% {
        transform: translate(var(--tx), var(--ty)) scale(1);
        opacity: 0;
      }
    }

    /* Spinny Stars */
    .spinny-star {
      position: absolute;
      font-size: 20px;
      opacity: 0;
      pointer-events: none;
      z-index: 50;
      animation: star-spin 1s linear infinite;
    }

    @keyframes star-spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Floating Hearts */
    .floating-heart {
      position: absolute;
      font-size: 24px;
      opacity: 0;
      pointer-events: none;
      z-index: 50;
      animation: heart-float 3s ease-in-out infinite;
    }

    @keyframes heart-float {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(10deg); }
    }

    /* Celebration Overlay */
    .celebration-overlay {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 999;
      display: none;
    }

    .modal-backdrop.open .celebration-overlay {
      display: block;
    }

    /* Landscape orientation adjustments */
    @media (max-height: 600px) and (orientation: landscape) {
      .modal-card {
        max-height: 85vh;
        overflow-y: auto;
      }
      
      .modal-poster {
        max-height: 200px;
        overflow: hidden;
      }
      
      .modal-poster img {
        max-height: 200px;
        object-fit: contain;
      }
    }

    /* Prevent text selection on buttons */
    .vote-btn, .modal-close {
      user-select: none;
      -webkit-user-select: none;
    }

    /* Better touch targets for mobile */
    @media (pointer: coarse) {
      .vote-btn {
        min-height: 44px;
        padding: 12px 16px;
      }
      
      .modal-close {
        min-width: 44px;
        min-height: 44px;
      }
    }
  </style>
</head>
<body>
  <div class="evm-wrapper">
    <div class="evm-header">
      <div class="evm-title">‡¥Æ‡µÅ‡¥ï‡µç‡¥ï‡¥Ç ‡¥Æ‡µÅ‡µª‡¥∏‡¥ø‡¥™‡µç‡¥™‡¥æ‡¥≤‡¥ø‡¥±‡µç‡¥±‡¥ø</div>
      <div class="evm-subtitle">‡¥°‡¥ø‡¥µ‡¥ø‡¥∑‡µª 19  ‡¥Æ‡¥Ç‡¥ó‡¥≤‡¥∂‡µç‡¥∂‡µá‡¥∞‡¥ø</div>
    </div>
    <div id="evm-rows" class="evm-rows"></div>
  </div>

  <!-- Modal -->
  <div id="vote-modal" class="modal-backdrop">
    <!-- Celebration Overlay for full-screen effects -->
    <div class="celebration-overlay" id="celebration-overlay"></div>

    <div class="modal-card">
      <!-- Success checkmark -->
      <div class="success-check"></div>

      <button id="modal-close-btn" class="modal-close" type="button">
        <span>‚úï</span>
      </button>

      <!-- Original confetti container -->
      <div class="confetti-container" id="confetti-container"></div>

      <h2 class="modal-title">‡¥µ‡µã‡¥ü‡µç‡¥ü‡µç ‡¥∞‡µá‡¥ñ‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥§‡µç‡¥§‡¥ø!</h2>
      <div id="modal-candidate" class="modal-subtitle"></div>

      <div class="modal-poster">
        <img id="modal-poster-img" src="" alt="Candidate Poster">
      </div>

      <p class="modal-footer-text">
        ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥µ‡µã‡¥ü‡µç‡¥ü‡µç ‡¥µ‡¥ø‡¥ú‡¥Ø‡¥ï‡¥∞‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥∞‡µá‡¥ñ‡¥™‡µç‡¥™‡µÜ‡¥ü‡µÅ‡¥§‡µç‡¥§‡¥ø‡¥Ø‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ.
      </p>
      <p class="modal-subtext">
        <!-- ‡¥°‡µÜ‡¥Æ‡µã ‡¥Æ‡¥æ‡¥§‡µç‡¥∞‡¥Æ‡¥æ‡¥£‡µç ‚Ä¢ ‡¥ï‡µç‡¥≤‡µã‡¥∏‡µç ‡¥ö‡µÜ‡¥Ø‡µç‚Äå‡¥§‡¥æ‡µΩ ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥µ‡µã‡¥ü‡µç‡¥ü‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥æ‡¥Ç. -->
      </p>
    </div>
  </div>

  <script>
    const config = {
      totalSlots: 8,
      candidateSlot: 4,
      candidate: {
        name: "‡¥∑‡¥´‡µÄ‡¥ñ‡µç ‡¥Æ‡¥æ‡¥ü‡¥æ‡¥Ø‡¥ø",
        party: "‡¥µ‡µÜ‡µΩ‡¥´‡µÜ‡¥Ø‡µº ‡¥™‡¥æ‡µº‡¥ü‡µç‡¥ü‡¥ø",
        iconPath: "assets/Gas_Cylinder.jpg",
        posterPath: "assets/Image.jpg"
      },
      beepSound: "assets/beep.mp3"
    };

    const BLINK_DURATION = 3000;
    const rowsContainer = document.getElementById('evm-rows');
    const modal = document.getElementById('vote-modal');
    const modalCloseBtn = document.getElementById('modal-close-btn');
    const modalCandidateText = document.getElementById('modal-candidate');
    const modalPosterImg = document.getElementById('modal-poster-img');
    const confettiContainer = document.getElementById('confetti-container');
    const celebrationOverlay = document.getElementById('celebration-overlay');

    let activeVoteButton = null;
    let activeLed = null;

    // Party effect emojis
    const PARTY_EMOJIS = ['üéâ', 'üéä', 'üéà', 'ü•≥', 'üéá', 'üéÜ', '‚ú®', 'üåü', 'üí´', '‚≠ê', '‚ù§Ô∏è', 'üíô', 'üíö', 'üíõ', 'üíú', 'üéØ', 'üèÜ', 'ü•á', 'üéñÔ∏è', 'üëè', 'üôå'];
    const PARTY_COLORS = ['#ef4444', '#3b82f6', '#10b981', '#f59e0b', '#8b5cf6', '#ec4899', '#06b6d4', '#84cc16'];

    // Initialize modal content
    modalCandidateText.textContent = `${config.candidate.name} ‚Ä¢ ${config.candidate.party}`;
    modalPosterImg.src = config.candidate.posterPath;
    modalPosterImg.alt = `${config.candidate.name} Poster`;

    function createRows() {
      for (let i = 1; i <= config.totalSlots; i++) {
        const row = document.createElement('div');
        row.className = 'evm-row';

        const serial = document.createElement('div');
        serial.className = 'serial';
        serial.textContent = i;

        const nameCell = document.createElement('div');
        const iconCell = document.createElement('div');
        iconCell.className = 'candidate-icon';

        const ledCell = document.createElement('div');
        const buttonCell = document.createElement('div');

        if (i === config.candidateSlot) {
          // Active candidate row
          nameCell.className = 'candidate-name';
          nameCell.textContent = config.candidate.name;

          const img = document.createElement('img');
          img.src = config.candidate.iconPath;
          img.alt = 'Party Icon';
          iconCell.appendChild(img);

          const led = document.createElement('div');
          led.className = 'led off';
          ledCell.appendChild(led);

          const btn = document.createElement('button');
          btn.type = 'button';
          btn.className = 'vote-btn';
          btn.textContent = 'VOTE';
          buttonCell.appendChild(btn);

          activeLed = led;
          activeVoteButton = btn;

          btn.addEventListener('click', handleVoteClick);
        } else {
          // Empty row visuals
          nameCell.className = 'placeholder name';

          const iconPlaceholder = document.createElement('div');
          iconPlaceholder.className = 'placeholder icon';
          iconCell.appendChild(iconPlaceholder);

          const led = document.createElement('div');
          led.className = 'led led-hidden';
          ledCell.appendChild(led);

          const btn = document.createElement('button');
          btn.type = 'button';
          btn.className = 'vote-btn hidden';
          btn.textContent = 'VOTE';
          btn.disabled = true;
          buttonCell.appendChild(btn);
        }

        row.appendChild(serial);
        row.appendChild(nameCell);
        row.appendChild(iconCell);
        row.appendChild(ledCell);
        row.appendChild(buttonCell);

        rowsContainer.appendChild(row);
      }
    }

    function handleVoteClick() {
      if (!activeVoteButton || !activeLed) return;

      // Lock button during entire beep + animation
      activeVoteButton.disabled = true;

      // Start LED blinking
      activeLed.classList.remove('off', 'on');
      activeLed.classList.add('blinking');

      // Play beep sound
      playBeepSound();

      // After 3 seconds: stop blinking, LED solid ON, then show popup
      setTimeout(() => {
        activeLed.classList.remove('blinking');
        activeLed.classList.add('on');
        openModal();
      }, BLINK_DURATION);
    }

    function playBeepSound() {
      try {
        const audio = new Audio(config.beepSound);
        audio.volume = 0.7;
        
        const playPromise = audio.play();
        
        if (playPromise !== undefined) {
          playPromise.catch(error => {
            console.log("Audio play attempt failed, continuing without sound:", error);
          });
        }
      } catch (error) {
        console.log("Could not play audio, continuing without sound:", error);
      }
    }

    function createPartyEffects() {
      // Clear previous effects
      confettiContainer.innerHTML = '';
      celebrationOverlay.innerHTML = '';

      // Create different types of party effects
      createConfetti();
      createEmojiParticles();
      createGlitter();
      createStreamers();
      createBubbles();
      createFireworks();
      createSpinnyStars();
      createFloatingHearts();
    }

    function createConfetti() {
      for (let i = 0; i < 30; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.textContent = PARTY_EMOJIS[Math.floor(Math.random() * PARTY_EMOJIS.length)];
        confetti.style.left = `${Math.random() * 100}%`;
        confetti.style.animationDelay = `${Math.random() * 1.5}s`;
        confetti.style.color = PARTY_COLORS[Math.floor(Math.random() * PARTY_COLORS.length)];
        confetti.style.fontSize = `${Math.random() * 20 + 16}px`;
        confettiContainer.appendChild(confetti);
      }
    }

    function createEmojiParticles() {
      for (let i = 0; i < 25; i++) {
        const particle = document.createElement('div');
        particle.className = 'emoji-particle';
        particle.textContent = PARTY_EMOJIS[Math.floor(Math.random() * PARTY_EMOJIS.length)];
        particle.style.left = `${Math.random() * 100}%`;
        particle.style.top = `${Math.random() * 100}%`;
        particle.style.animation = `confetti-fall ${Math.random() * 2 + 1.5}s cubic-bezier(0.215, 0.61, 0.355, 1) ${Math.random() * 0.5}s forwards`;
        particle.style.color = PARTY_COLORS[Math.floor(Math.random() * PARTY_COLORS.length)];
        particle.style.fontSize = `${Math.random() * 24 + 20}px`;
        celebrationOverlay.appendChild(particle);
      }
    }

    function createGlitter() {
      for (let i = 0; i < 50; i++) {
        const glitter = document.createElement('div');
        glitter.className = 'glitter';
        glitter.style.left = `${Math.random() * 100}%`;
        glitter.style.animation = `glitter-fall ${Math.random() * 3 + 2}s linear ${Math.random() * 1}s infinite`;
        glitter.style.backgroundColor = PARTY_COLORS[Math.floor(Math.random() * PARTY_COLORS.length)];
        glitter.style.boxShadow = `0 0 15px ${PARTY_COLORS[Math.floor(Math.random() * PARTY_COLORS.length)]}`;
        glitter.style.width = `${Math.random() * 8 + 4}px`;
        glitter.style.height = glitter.style.width;
        celebrationOverlay.appendChild(glitter);
      }
    }

    function createStreamers() {
      const streamerColors = ['red', 'blue', 'green', 'yellow', 'purple'];
      for (let i = 0; i < 20; i++) {
        const streamer = document.createElement('div');
        streamer.className = `streamer ${streamerColors[Math.floor(Math.random() * streamerColors.length)]}`;
        streamer.style.left = `${Math.random() * 100}%`;
        streamer.style.animation = `streamer-fall ${Math.random() * 2 + 1.5}s ease-in ${Math.random() * 0.5}s forwards`;
        streamer.style.width = `${Math.random() * 6 + 3}px`;
        streamer.style.height = `${Math.random() * 60 + 30}px`;
        celebrationOverlay.appendChild(streamer);
      }
    }

    function createBubbles() {
      for (let i = 0; i < 15; i++) {
        const bubble = document.createElement('div');
        bubble.className = 'bubble';
        bubble.style.left = `${Math.random() * 100}%`;
        bubble.style.animation = `bubble-rise ${Math.random() * 4 + 3}s ease-in ${Math.random() * 1}s infinite`;
        bubble.style.backgroundColor = PARTY_COLORS[Math.floor(Math.random() * PARTY_COLORS.length)];
        bubble.style.width = `${Math.random() * 30 + 15}px`;
        bubble.style.height = bubble.style.width;
        celebrationOverlay.appendChild(bubble);
      }
    }

    function createFireworks() {
      for (let i = 0; i < 8; i++) {
        setTimeout(() => {
          const x = Math.random() * 100;
          const y = Math.random() * 100;
          
          for (let j = 0; j < 12; j++) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            const angle = (j / 12) * Math.PI * 2;
            const distance = Math.random() * 100 + 50;
            const tx = Math.cos(angle) * distance;
            const ty = Math.sin(angle) * distance;
            
            firework.style.left = `${x}%`;
            firework.style.top = `${y}%`;
            firework.style.setProperty('--tx', `${tx}px`);
            firework.style.setProperty('--ty', `${ty}px`);
            firework.style.animation = `firework-explode ${Math.random() * 0.8 + 0.5}s ease-out forwards`;
            firework.style.backgroundColor = PARTY_COLORS[Math.floor(Math.random() * PARTY_COLORS.length)];
            celebrationOverlay.appendChild(firework);
            
            setTimeout(() => {
              if (firework.parentNode) {
                firework.remove();
              }
            }, 1000);
          }
        }, i * 300);
      }
    }

    function createSpinnyStars() {
      for (let i = 0; i < 10; i++) {
        const star = document.createElement('div');
        star.className = 'spinny-star';
        star.textContent = '‚≠ê';
        star.style.left = `${Math.random() * 100}%`;
        star.style.top = `${Math.random() * 100}%`;
        star.style.animation = `star-spin ${Math.random() * 2 + 1}s linear infinite, confetti-fall ${Math.random() * 3 + 2}s ease-in ${Math.random() * 0.5}s forwards`;
        star.style.fontSize = `${Math.random() * 24 + 20}px`;
        celebrationOverlay.appendChild(star);
      }
    }

    function createFloatingHearts() {
      for (let i = 0; i < 8; i++) {
        const heart = document.createElement('div');
        heart.className = 'floating-heart';
        heart.textContent = '‚ù§Ô∏è';
        heart.style.left = `${Math.random() * 100}%`;
        heart.style.top = `${Math.random() * 100}%`;
        heart.style.animation = `heart-float ${Math.random() * 4 + 2}s ease-in-out infinite, confetti-fall ${Math.random() * 4 + 3}s ease-in ${Math.random() * 1}s forwards`;
        heart.style.fontSize = `${Math.random() * 28 + 24}px`;
        celebrationOverlay.appendChild(heart);
      }
    }

    function openModal() {
      // Ensure poster image is loaded
      modalPosterImg.src = config.candidate.posterPath;
      modal.classList.add('open');
      
      // Create party effects
      createPartyEffects();
      
      // Continue creating new effects every few seconds
      const effectInterval = setInterval(() => {
        if (modal.classList.contains('open')) {
          createEmojiParticles();
          createGlitter();
        } else {
          clearInterval(effectInterval);
        }
      }, 2000);
      
      // Add hover effect for the poster
      modalPosterImg.addEventListener('mouseenter', () => {
        modalPosterImg.style.transform = 'scale(1.05)';
      });
      
      modalPosterImg.addEventListener('mouseleave', () => {
        modalPosterImg.style.transform = 'scale(1)';
      });
    }

    function closeModal() {
      modal.classList.remove('open');
      // Reset LED
      if (activeLed) {
        activeLed.classList.remove('on');
        activeLed.classList.add('off');
      }
      // Re-enable voting (revote allowed)
      if (activeVoteButton) {
        activeVoteButton.disabled = false;
      }
    }

    modalCloseBtn.addEventListener('click', closeModal);

    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        closeModal();
      }
    });

    createRows();

    console.log("EVM Demo loaded. Click VOTE to see the effect!");
  </script>
</body>
</html>